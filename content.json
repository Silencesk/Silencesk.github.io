[{"title":"Spring Boot应用程序日志输出策略","date":"2018-08-18T16:17:50.848Z","path":"posts/programming/2018-08-19-spring-boot-logback.html","text":"Spring Boot应用程序日志输出策略：不同日志级别分文件独立存储、按天、按大小滚动；基于Logback 背景 Spring Boot为我们提供了logback的集成，使我们的应用程序能很方便的实现日志的输出 其默认配置的特点 121. 日志输出是存放于同一日志文件，不论日志级别2. 日志输出是按照文件大小进行滚动，每10M便会生成一个文件 这样的默认配置并不是很方便于我们的错误排查，主要的需求点： 1231. 不同级别的日志存放到不同文件2. 需按天进行滚动3. 按文件大小滚动（如果只是按天滚动，当某天的日志量特别大时，还是会产生巨大的日志文件；一个上百M的文件，我们想要拿来排查问题，就已经不方便了） 具体实现 Spring Boot提供了自定义日志配置方式 在resources目录目录下添加文件logback-spring.xml 完整配置 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;configuration&gt; &lt;!--日志输出格式与spring boot默认格式保持一致--&gt; &lt;conversionRule conversionWord=\"clr\" converterClass=\"org.springframework.boot.logging.logback.ColorConverter\" /&gt; &lt;conversionRule conversionWord=\"wex\" converterClass=\"org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter\" /&gt; &lt;conversionRule conversionWord=\"wEx\" converterClass=\"org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter\" /&gt; &lt;property name=\"CONSOLE_LOG_PATTERN\" value=\"$&#123;CONSOLE_LOG_PATTERN:-%clr(%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;)&#123;faint&#125; %clr($&#123;LOG_LEVEL_PATTERN:-%5p&#125;) %clr($&#123;PID:- &#125;)&#123;magenta&#125; %clr(---)&#123;faint&#125; %clr([%15.15t])&#123;faint&#125; %clr(%-40.40logger&#123;39&#125;)&#123;cyan&#125; %clr(:)&#123;faint&#125; %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&#125;\"/&gt; &lt;property name=\"FILE_LOG_PATTERN\" value=\"$&#123;FILE_LOG_PATTERN:-%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; $&#123;LOG_LEVEL_PATTERN:-%5p&#125; $&#123;PID:- &#125; --- [%t] %-40.40logger&#123;39&#125; : %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&#125;\"/&gt; &lt;property name=\"MAX_SIZE\" value=\"10MB\"/&gt; &lt;!--输出到控制台 ConsoleAppender--&gt; &lt;appender name=\"CONSOLE\" class=\"ch.qos.logback.core.ConsoleAppender\"&gt; &lt;!--展示格式 layout--&gt; &lt;layout class=\"ch.qos.logback.classic.PatternLayout\"&gt; &lt;pattern&gt;$&#123;CONSOLE_LOG_PATTERN&#125;&lt;/pattern&gt; &lt;/layout&gt; &lt;/appender&gt; &lt;!--错误日志--&gt; &lt;appender name=\"errorFile\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt; &lt;file&gt;logs/error.log&lt;/file&gt; &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\"&gt; &lt;fileNamePattern&gt;logs/error-%d&#123;yyyy-MM-dd&#125;-%i.log&lt;/fileNamePattern&gt; &lt;maxFileSize&gt;$&#123;MAX_SIZE&#125;&lt;/maxFileSize&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;$&#123;FILE_LOG_PATTERN&#125;&lt;/pattern&gt; &lt;/encoder&gt; &lt;filter class=\"ch.qos.logback.classic.filter.LevelFilter\"&gt;&lt;!-- 只打印错误日志 --&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!--info日志--&gt; &lt;appender name=\"infoFile\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt; &lt;file&gt;logs/info.log&lt;/file&gt; &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\"&gt; &lt;fileNamePattern&gt;logs/info-%d&#123;yyyy-MM-dd&#125;-%i.log&lt;/fileNamePattern&gt; &lt;maxFileSize&gt;$&#123;MAX_SIZE&#125;&lt;/maxFileSize&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;$&#123;FILE_LOG_PATTERN&#125;&lt;/pattern&gt; &lt;/encoder&gt; &lt;filter class=\"ch.qos.logback.classic.filter.LevelFilter\"&gt; &lt;level&gt;INFO&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!--debug日志--&gt; &lt;appender name=\"debugFile\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt; &lt;file&gt;logs/debug.log&lt;/file&gt; &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\"&gt; &lt;fileNamePattern&gt;logs/debug-%d&#123;yyyy-MM-dd&#125;-%i.log&lt;/fileNamePattern&gt; &lt;maxFileSize&gt;$&#123;MAX_SIZE&#125;&lt;/maxFileSize&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;$&#123;FILE_LOG_PATTERN&#125;&lt;/pattern&gt; &lt;/encoder&gt; &lt;filter class=\"ch.qos.logback.classic.filter.LevelFilter\"&gt; &lt;level&gt;DEBUG&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;root level=\"info\"&gt; &lt;appender-ref ref=\"CONSOLE\"/&gt; &lt;appender-ref ref=\"errorFile\"/&gt; &lt;appender-ref ref=\"infoFile\"/&gt; &lt;appender-ref ref=\"debugFile\"/&gt; &lt;/root&gt;&lt;/configuration&gt; 配置解读 效果图总结 多看官方文档 看spring boot源码，完整配置中的日志输出格式就是从源码中copy过来的","tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://Silencesk.github.io/tags/Spring-Boot/"}]},{"title":"书单","date":"2017-03-29T01:14:06.000Z","path":"posts/other/2017-03-29-book-list.html","text":"个人书单 经济学国富论，聪明的投资者，蓝海战略，致巴菲特股东的信，活法，基业长青，财富自由之路 文学东野圭吾：白夜行，解忧杂货店春上村树：挪威的森林路遥：人生，平凡的世界刘慈欣：三体郝景芳：北京折叠怎样让自己变得有思想岛上书店权利与繁荣反叛的科学家 技术硅谷之谜淘宝技术十年程序员的呐喊跃进-成为高手得技术java8实战代码之殇如何专业学语文算法的乐趣见识","tags":[{"name":"wiki","slug":"wiki","permalink":"https://Silencesk.github.io/tags/wiki/"}]},{"title":"时光轴","date":"2017-03-28T14:18:26.000Z","path":"posts/other/2017-03-28-time-line.html","text":"这里是个人心情的河流，随时光流淌，或文字或图片，我还存在着。。。 2016.12.15 23:20如果在双方最有热情的时候，并没有选择在一起，那拖着拖着便不会在一起了。 2016.12.16 22:07如果只是路过，我就在终点等你。 2016.12.17 18:07你想和她做恋人，而她只想和你做朋友，最终，做不成恋人，也不再是朋友。@lt: 如果心里还记得初见时的美好，大概也会是朋友吧，人性果然是卑劣的！ 2016.12.20 23:11人类活着最重要的诉求是什么？情感？自我实现？我觉得是后者，前者只是生活的调味剂，而后者才是人活着的意义。 2016.12.24 07:57在一个个怀疑，否定，不确信的日子里，你需要挺住。 2016.12.28 22:35可不要忙着忙着，把自己的方向给弄丢了。 2016.12.31 10:13我便只想找一个家人。 2017.01.01 17:38我只想做一个不一样的人。 2017.01.11 01:03你说过的，这是寂寞。 2017.01.16 22:432017小目标：找到内心的安定与平和。 2017.01.17 22:582017主旋律：读书，编码，生活。坚持，让自己成为一个不一样的人。 2017.01.21 22:22父母辈的生活真的很不容易，很辛苦，我自己所在的生活条件比他们优越很多，为什么就不能自己多努力一点，让他们轻松一些。 2017.03.02 20:33有一种情绪叫自毁。 2017.03.19 13:41open，走出去，给自己更广阔的天地。 2017.03.25 05:22做任何事情都是有方法的，也是人们常说的套路。 2017.03.28 22:34我希望你一直用力的活着；也要开心。 2017.03.29 09:27虚心与恒心","tags":[{"name":"时光轴","slug":"timeline","permalink":"https://Silencesk.github.io/tags/timeline/"}]},{"title":"spring-boot + Intellij Idea + jrebel应用自动reload方案","date":"2017-03-28T09:24:13.000Z","path":"posts/programming/2017-03-28-reload.html","text":"背景一直都琢磨着，想拥有这样的功能：对于即时修改的代码，无需重启应用程序，便能自动reload changes；以减少因重启应用花费的时间，提升程序开发效率。曾经花费了一些时间尝试过修改代码的reload相关方案，包括spring-reloaded、spring-boot-devtools；但使用下来，结果并不理想。一直也知道，在reload方案中jrebel是最好的机制，但需要收费，也就没有过多的去关注。对于代码修改自动reload也就成为了自个心中的一个梗，悬而未解；我相信对于有问题解决强迫症的同学来说，这是很不爽的。今天因为做一个东西，又激起了自身折腾的兴致，决定重新尝试下，把这个悬而未解的问题拿下。在花费了一些时间之后，总算是有所收获，达到了自己想要的效果。所使用的方式：基于jrebel，这货收费果然是有道理的，下面就讲一下具体实现步骤。 环境自己当前的开发环境： MacOS + spring-boot + intellij ideal 具体步骤 在intellij ideal中，安装jrebel插件 安装成功后，需要重启，效果图。图中所框图标，为jrebel方式run、debug启动 这时候的jrebel是没有进行注册的，需要进行注册。 访问myJrebel，可能需要翻墙，下面的操作也是 。 至于翻墙手段，可以使用lantern。。每月有700M的免费流量，如果不去youtobe，只是查查资料，也差不多够了。需注意，只有在需要访问被墙的网站才运行lantern。 通过facebook或twitter账户登录注册就可以获得免费的激活码 如果你已有facebook或twitter，那就直接登录；如果没有，那就注册一个吧 注册facebook，直接使用手机号进行注册。因使用邮箱的facebook还是需要手机号确认，才能注册生效的 my.jrebel登录成功后，需要填写一些信息，随便填吧 成功后，会有免费的注册码了 copy该注册码到jrebel激活界面去吧 进行jrebel配置，对需要启动的应用程序勾选，enable change ,会在对应的resouces目录增加rebel.xml。该文件并非源代码，考虑加入至.gitignore文件中 tips：因ideal源文件是自动保存的，需要手动build之后，才能将修改的文件进行编译。不像在eclipse里边，ctrl+s保存之后就会自动重新build。这里可以自行设置一个快捷键，在修改后使用方便的快捷键重新build。对于MacOS，直接设置ctrl+s就OK了。 如果有如下打印信息，则证明设置生效，后面就自行体验jrebel的reload神奇吧 jrebel reload的范围 方法内部代码的修改 增加新的方法，也不需要restart controller增加新的requestMapping 代理类逻辑的变更，也是不需要重启的 定义新的static变量，成员变量都是可以reload","tags":[{"name":"devtools","slug":"devtools","permalink":"https://Silencesk.github.io/tags/devtools/"}]},{"title":"知识收集","date":"2017-03-28T09:23:03.000Z","path":"posts/wiki/2017-03-28-note-book.html","text":"备忘1234567891011121314151617-- programming learn listhttps://github.com/vhf/free-programming-books/blob/master/free-programming-books-zh.md-- Java知识图谱收集整理http://mp.weixin.qq.com/s?__biz=MjM5MzMyNzg0MA==&amp;mid=2650402258&amp;idx=1&amp;sn=318496c6d81c14352cb2f53628654f3d&amp;scene=1&amp;srcid=0515lnZrJf0HTTZWCiSwrmdD#rd-- github rankhttps://github-ranking.com/-- Java工程师成神之路~http://mp.weixin.qq.com/s?__biz=MjM5NzA1MTcyMA==&amp;mid=400861341&amp;idx=3&amp;sn=be7603f8ece9a9cb09f12919fb2a6128&amp;scene=2&amp;srcid=1217yh3QoEJkhPj2g3luMJ80&amp;from=timeline&amp;isappinstalled=0#rd-- 我的Java后端书架 2016(by 江南白衣)https://www.douban.com/doulist/44353472/-- 两周项目与文章总结https://www.douban.com/note/509894757/?type=like 博客大家综合 并发编程网 ThoughtWorks洞见 后端 江南白衣-花样的年华 有孚-deepinmind 廖雪峰 阮一峰的个人网站 阿福 - 一个架构士的思考与沉淀 博客 | 奔跑中的奶酪 首页 - 美团点评技术团队 程序猿DD 酷 壳 – COOLSHELL 漠然 泥瓦匠BYSocket 纯洁的微笑 刘未鹏 | Mind Hacks 思维改变生活 亦山的个人主页 许进沉思录-专注于云计算与物联网技术研究 夕水溪下 前端 Litten imys","tags":[{"name":"wiki","slug":"wiki","permalink":"https://Silencesk.github.io/tags/wiki/"}]},{"title":"博客搭建","date":"2017-03-28T09:22:44.000Z","path":"posts/wiki/2017-03-28-blog.html","text":"这里将记录个人博客搭建的历程，如果你也想搭建一个属于个人私有空间的博客系统，那可以继续阅读下去。希望这篇文章的记录，能对你有所帮助。 博客选型关于选型参考类的文章：hexo入门指南；这篇文章主题是hexo相关的，但作者在文章中也讲述了关于选型方面的内容，可供参考。对于我个人来说，能支持Markdown，一套自我感觉良好的主题（自由发挥了）就ok了。 HexoHexo是一个快速，简单并且强大的博客框架。你可以用Markdown编写文章，Hexo则可以在几秒以内生成拥有漂亮主题的静态文件。 本来是想写写教程的，发现人家官方便有很详尽的文档，也建议大家多看看官方资料。虽然这样时间花的可能多些，但试着去理解原生的东西总会让我们收获更大，若实在觉得难以理解，便可以搜索其他资料，加以参考。Hexo 主题indigo 网站参考 源码参考 搭建教程 主题yilia 网站参考：litten or joway 主题notes 网站参考 源码参考* 需按照步骤，重新安装Hexo 规划功能列表 搜索 相册 打赏 自动目录 教程 初级教程：(Create and host your blog for free with hexo &amp; Github)[https://malekbenz.com/blog/2016/09/10/Create-Host-Blog-for-free-with-Hexo-Github] 参考现成的解决方案，总要比自己折腾，成果来的快些。参考下这位仁兄的Hexo折腾记 troubleshooting 使用hexo命令会报如下错误123456Error: Cannot find module './build/Release/DTraceProviderBindings' at Function.Module._resolveFilename (module.js:469:15) at Function.Module._load (module.js:417:25) at Module.require (module.js:497:17) at require (internal/module.js:20:19) at Object.&lt;anonymous&gt; (/usr/local/lib/node_modules/hexo-cli/node_modules/dtrace-provider/dtrace-provider.js:17:23) 找到dtrace-provider.js，并将console.log的地方注释掉就ok了。参考 node scripts/install.js 卡住不动npm默认会从国外的服务器下载，可指定国内的淘宝npm镜像源参考1 or 参考2 按照正常的步骤执行了，但在hexo server后，进行访问时 Error Cannot GET /hexo安装缺失一些内容，参考 使用hexo deploy报错 123456TypeError: source.replace is not a function at Object.exports.parse (/Users/mokeo/blog/node_modules/.1.4.2@swig/lib/parser.js:438:19) at parse (/Users/mokeo/blog/node_modules/.1.4.2@swig/lib/swig.js:354:19) at Object.precompile (/Users/mokeo/blog/node_modules/.1.4.2@swig/lib/swig.js:486:23) at Object.compile (/Users/mokeo/blog/node_modules/.1.4.2@swig/lib/swig.js:606:16) at commitMessage ..... 关键信息commitMessage。因博客根目录下的，_config.yml配置文件中deploy.message提交信息错误。需要加上引号，参考12345deploy: type: git repo: https://github.com/Silencesk/Silencesk.github.io.git branch: master message: \"&#123;&#123; now('YYYY-MM-DD HH:mm:ss') &#125;&#125;\" jekyll// TODO: 待补充。。。","tags":[{"name":"wiki","slug":"wiki","permalink":"https://Silencesk.github.io/tags/wiki/"}]},{"title":"Hello World","date":"2017-03-27T15:11:24.000Z","path":"posts/programming/2017-03-27-hello-world.html","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","tags":[]}]